---
title: "Visualisations_Final"
output: html_document
date: "2025-12-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install.package(igraph)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(igraph)

```

Create Network visualization 

```{r}

```


Create scatter/line plot to show seed vs nestedness 

```{r}
#final_data <- read.csv("/Users/isabellenollette/Desktop/final_community_assembly-SJIN/data/final_df")
final_data <- read.csv("/Users/sydneyjames/OneDrive_UniversityofOregon/final_community_assembly-SJIN/data/final_df")


final_data2 <- final_data %>%
  separate(Standsr1, into = c("Stand", "Mix"), sep = "_") %>%
  group_by(Mix) %>%
  mutate(
    PollinationBenefit = av_OSeeds_Per_Bloom - av_CSeeds_Per_Bloom
  )

lm_POLLINATORBENEFITvNESTEDNESS <- lm(PollinationBenefit ~ av_nestedness_null * Mix, data = final_data2)
summary(lm_POLLINATORBENEFITvNESTEDNESS)
anova(lm_POLLINATORBENEFITvNESTEDNESS)

ggplot(final_data2, aes(x = av_nestedness_null, y = PollinationBenefit, color = Mix)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  theme_bw() +
  labs(
    title = "Relationship Between Nestedness and Seed Set",
    x = "Standardized Nestedness",
    y = "Seed Set"
  )
ggsave("nestednessVseedset_bymix.png", width = 6, height = 4, dpi = 300)

#final_dfMIX <- read.csv("/Users/isabellenollette/Desktop/final_community_assembly-SJIN/data/final_dfMIX.csv")
final_dfMIX <- read.csv("/Users/sydneyjames/OneDrive_UniversityofOregon/final_community_assembly-SJIN/data/final_dfMIX.csv")

final_dfMIX <- final_dfMIX %>%
  mutate(
    PollinationBenefit = av_OSeeds_Per_Bloom - av_CSeeds_Per_Bloom,
    Mix = mix
  )

ggplot(final_dfMIX, aes(x = av_nestedness_null, y = PollinationBenefit, color = Mix)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  theme_bw() +
  labs(
    title = "Nestedness vs Seed Set Averaged by Mix",
    x = "Standardized Nestedness",
    y = "Seed Set"
  )
ggsave("nestednessVseedset.png", width = 6, height = 4, dpi = 300)

# just plot mix 4 and 5 (highest and lowest nestedness)

final_dfMIX_edit <- final_dfMIX %>%
  mutate(
    PollinationBenefit = av_OSeeds_Per_Bloom - av_CSeeds_Per_Bloom,
    Mix = mix
  ) %>%
  filter(mix == "Mix4" | mix == "Mix5" | mix == "Mix1" | mix == "Mix2")

ggplot(final_dfMIX_edit, aes(x = av_nestedness_null, y = PollinationBenefit, color = Mix)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  theme_bw() +
  labs(
    title = "Nestedness vs Seed Set",
    x = "Standardized Nestedness",
    y = "Seed Set"
  )
ggsave("nestednessVseedset_bymix.png", width = 6, height = 4, dpi = 300)

```

